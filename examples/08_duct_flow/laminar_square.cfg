# 3D Square Duct Laminar Flow
# Solves flow in a square duct with no-slip walls at y,z boundaries
# and periodic in x (streamwise). Validates against analytical solution.

# --- Grid (3D) ---
Nx = 16
Ny = 32
Nz = 32

# --- Domain ---
# Streamwise: periodic
x_min = 0.0
x_max = 6.283185307179586   # 2*pi

# Cross-section: [-1, 1] x [-1, 1] square duct
y_min = -1.0
y_max = 1.0
z_min = -1.0
z_max = 1.0

# No grid stretching (uniform grid)
stretch_y = false
stretch_z = false

# --- Physics ---
nu = 0.01              # Kinematic viscosity
dp_dx = -1.0           # Pressure gradient (drives the flow)

# --- Solver settings ---
dt = 0.001
adaptive_dt = true
CFL_max = 0.5
max_iter = 10000
tol = 1e-8

# --- Turbulence model ---
turb_model = none      # Laminar flow

# --- Numerical schemes ---
convective_scheme = central

# --- Poisson solver ---
poisson_tol = 1e-8
poisson_max_iter = 5000
poisson_omega = 1.8

# --- Output ---
output_dir = output/
output_freq = 500
num_snapshots = 5
verbose = true
write_fields = true
