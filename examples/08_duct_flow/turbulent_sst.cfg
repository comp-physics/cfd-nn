# 3D Square Duct Turbulent Flow - SST k-omega
# Turbulent flow in a square duct using SST k-omega model

# --- Grid (3D) ---
Nx = 32
Ny = 64
Nz = 64

# --- Domain ---
x_min = 0.0
x_max = 6.283185307179586   # 2*pi
y_min = -1.0
y_max = 1.0
z_min = -1.0
z_max = 1.0

# Wall-normal stretching for turbulent boundary layers
stretch_y = true
stretch_beta = 2.0
stretch_z = true
stretch_beta_z = 2.0

# --- Physics ---
# For turbulent flow, set higher Re via smaller nu
nu = 0.0001            # Re ~ 10000 based on half-width and u_bulk
dp_dx = -0.01

# --- Solver settings ---
dt = 0.0005
adaptive_dt = true
CFL_max = 0.3
max_iter = 15000       # Steady turbulent RANS
tol = 1e-6

# --- Turbulence model ---
turb_model = sst

# --- Numerical schemes ---
convective_scheme = upwind

# --- Poisson solver ---
poisson_tol = 1e-6
poisson_max_iter = 10
poisson_omega = 1.8

# --- Output ---
output_dir = output/
output_freq = 500
num_snapshots = 10
verbose = true
write_fields = true
