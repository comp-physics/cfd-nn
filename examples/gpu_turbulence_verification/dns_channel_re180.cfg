# Channel Flow DNS - Re_tau ≈ 180
# Resolve turbulent structures directly (no modeling)
#
# Reference: Moser, Kim & Mansour (1999) DNS
#
# Grid: 192×96×192, Lx=4π, Ly=2, Lz=2π
#   Δx+ ≈ 11.8, Δz+ ≈ 5.9, y1+ ≈ 0.29 (stretched)
#
# Stability recipe (v13):
#   - Directional CFL: CFL_xz=0.30 (x/z), CFL_max=0.15 (y, strict for stretched grid)
#   - dt_safety=0.85 (headroom for within-step CFL growth in SSPRK3)
#   - 3D Laplacian velocity filter (x/y/z) damps grid-scale energy on stretched grid
#   - Trip forcing triggers transition, ramps off by physical time 0.20
#   - PCG breakdown restart prevents Poisson solver hard-abort

Nx = 192
Ny = 96
Nz = 192
x_min = 0.0
x_max = 12.566370614
y_min = -1.0
y_max = 1.0
z_min = 0.0
z_max = 6.283185307

# Re_tau = u_tau * delta / nu = 180  →  nu = 1/180
nu = 0.005555556
dp_dx = -1.0
rho = 1.0

# Grid stretching for wall resolution
stretch_y = true
stretch_beta = 2.0

# DNS — no turbulence model
turb_model = none

# Time integration
simulation_mode = unsteady
dt = 0.001
adaptive_dt = true
CFL_max = 0.15
CFL_xz = 0.30
dt_safety = 0.85
max_steps = 6000

# DNS numerics
convective_scheme = skew
time_integrator = rk3
perturbation_amplitude = 0.05

# Trip forcing for turbulence transition
trip_enabled = true
trip_x_start = -1
trip_x_end = -1
trip_amplitude = 1.0
trip_duration = 0.20
trip_ramp_off_start = 0.10
trip_n_modes_z = 16
trip_force_w = true
trip_w_scale = 2.0

# Explicit velocity filter (3D Laplacian, damps grid-scale energy on stretched grid)
filter_strength = 0.03
filter_interval = 2

# Poisson solver
poisson_solver = mg
poisson_fixed_cycles = 16
poisson_max_vcycles = 16

# Output
output_dir = output/dns_channel_re180/
write_fields = false
verbose = false
gpu_only_mode = true
perf_mode = true
