# Square Duct DNS
# Resolve turbulent structures including corner effects
#
# Key physics:
#   - Secondary flows (Prandtl's 2nd kind)
#   - Corner vortices
#   - Turbulent structures in all 3 directions
#
# Domain: 4π × 2 × 2 (square cross-section)

Nx = 64
Ny = 96
Nz = 96
x_min = 0.0
x_max = 12.566370614
y_min = -1.0
y_max = 1.0
z_min = -1.0
z_max = 1.0

# Moderate Re for DNS feasibility
nu = 0.005
dp_dx = -1.0
rho = 1.0

# No stretching for duct (walls on all sides)
stretch_y = false
stretch_z = false

# DNS - NO turbulence model
turb_model = none

# Unsteady
simulation_mode = unsteady
dt = 0.001
adaptive_dt = true
CFL_max = 0.5
max_steps = 5000

# DNS numerics
convective_scheme = skew
time_integrator = rk3

# Initial perturbation
perturbation_amplitude = 0.1

# Poisson solver
poisson_solver = auto
poisson_tol_rhs = 1e-8

# Output
output_dir = output/dns_duct/
num_snapshots = 50
write_fields = true
verbose = true
