# 3D Taylor-Green Vortex - Re = 1600 (DNS Transition to Turbulence)
# THE classic DNS benchmark for transition to turbulence
#
# Reference: Brachet et al. (1983), JFM 130, 411-452
#            van Rees et al. (2011), JCP 230, 3243-3275
#
# Physics:
#   - Initial condition: TGV with V0=1, L=1
#   - Re = V0*L/nu = 1600
#   - Vortex stretching leads to turbulence transition around t=5-9
#   - Peak enstrophy around t=9
#   - Energy cascade to small scales
#
# Key validation metrics:
#   - Kinetic energy decay: KE(t)/KE(0)
#   - Enstrophy peak timing and magnitude
#   - Dissipation rate evolution: epsilon = -dKE/dt
#
# IMPORTANT: This is DNS (no turbulence model) - resolving ALL scales
# Grid requirement: At least 64^3 for Re=1600, 128^3 for good resolution

# Domain: [0, 2*pi]^3 (periodic cube)
Nx = 64
Ny = 64
Nz = 64
x_min = 0.0
x_max = 6.283185307
y_min = 0.0
y_max = 6.283185307
z_min = 0.0
z_max = 6.283185307

# Physics - Re = 1600
# nu = 1/Re = 0.000625
nu = 0.000625
dp_dx = 0.0
rho = 1.0

# No stretching (periodic domain)
stretch_y = false
stretch_z = false

# NO turbulence model - this is DNS!
turb_model = none

# Time stepping - UNSTEADY (time-accurate integration)
simulation_mode = unsteady
T_final = 20.0
dt = 0.005
adaptive_dt = true
CFL_max = 0.5
max_steps = 4000

# Numerical schemes - energy-conserving for DNS
convective_scheme = skew
time_integrator = rk3

# Poisson solver - FFT for triply-periodic
poisson_solver = auto
poisson_tol_rhs = 1e-8

# Output - many snapshots to capture transition
output_dir = output/tgv_re1600_dns/
num_snapshots = 40
write_fields = true
postprocess = false
verbose = true
