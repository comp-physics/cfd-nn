# 3D Turbulent Square Duct Flow - EARSM (Anisotropic)
# Critical test for anisotropic turbulence modeling
#
# WHY EARSM FOR DUCT FLOW:
#   - Isotropic models (SST, k-omega) CANNOT predict secondary flows
#   - Real turbulent duct flow has corner vortices (Prandtl's 2nd kind)
#   - EARSM captures Reynolds stress anisotropy that drives secondary motion
#   - This is THE litmus test for anisotropic turbulence models
#
# Expected observations:
#   - Secondary flow: v,w velocities ~1-2% of bulk u
#   - Eight corner vortices (2 per corner)
#   - Bulging of iso-velocity contours toward corners
#   - Better skin friction prediction than isotropic models

# Domain: 4*pi x 2 x 2
Nx = 32
Ny = 64
Nz = 64
x_min = 0.0
x_max = 12.566370614
y_min = -1.0
y_max = 1.0
z_min = -1.0
z_max = 1.0

# Physics
nu = 0.002
dp_dx = -1.0
rho = 1.0

# No stretching for duct
stretch_y = false
stretch_z = false

# Turbulence: EARSM Wallin-Johansson (anisotropic - captures secondary flow)
turb_model = earsm_wj

# Time stepping - steady RANS
simulation_mode = steady
dt = 0.001
adaptive_dt = true
CFL_max = 0.6
max_steps = 40000
tol = 1e-7

# Numerical schemes
convective_scheme = central
time_integrator = euler

# Poisson solver
poisson_solver = auto
poisson_tol_rhs = 1e-6

# Output
output_dir = output/duct_turbulent_earsm/
num_snapshots = 10
write_fields = true
postprocess = true
verbose = true
